import{d as e,g as a,a as s,b as l,j as t,O as n,P as o,h as i,u as r,F as u,k as d,l as c,E as v,G as m,H as p}from"./vendor.8d059d2b.js";import{c as f,u as y,b as g,e as k,f as b,S as h,A as w,g as E}from"./index.6d51bcce.js";const C=e=>e.match(/^[a-zA-Z][a-zA-Z0-9_]{4,15}$/)?"":"参数必须为字母开头的5-16位数字和字母组合",U=v();m("data-v-5c01e9b3");const _={class:"signin-container"},R={class:"signin-main"},x={class:"signin-title"},A=t("div",null,"嘿;-) 好巧在这里遇到您.",-1),N=d(" 这里是远浅自建用来叨叨的网站, 要是您懒得注册可以直接点这里去逛逛。 "),$=t("div",{class:"signin-info"}," 直接输入登录名称开始探险叭~我们很智能哒~会自动帮你切换登录/注册 ",-1),I={class:"signin-form"},T={class:"form-account"},j={key:0},V={class:"summary"},z=d(" 注册一下不会有任何损失,甚至会变得更加 "),D=t("del",null,"沙雕",-1),F=d(" 快乐。 ");p();var G=e({expose:[],setup(e){const v=f(),m=y(),p=g(),G=ref(""),H=ref(""),O=ref(""),S=ref(!1),Z=computed((()=>m.state.User.Id));watch(G,(e=>{e.trim()&&k({type:"loginName",value:e.trim()}).then((e=>{1000005===e.Result?S.value=!1:S.value=!0}))}));const M=async()=>{const e=C(G.value.trim());if(e)return void v.error(e);const a=await b({type:"loginName",value:G.value.trim(),password:O.value.trim()});if((null==a?void 0:a.ErrorCode)||!(null==a?void 0:a.Result))return void v.error(`${a.ErrorCode} ${a.ErrorMsg}`);const s=a.Result.Token,l=a.Result.TokenAvailableDays;h(s,l),m.dispatch(w.GET_AUTHED_USER_INFO),v.success(`欢迎 ${null==a?void 0:a.Result.UserInfo.Nickname} 前来观光`,{onClose(){p.back()}})},P=async()=>{const e=C(G.value.trim());if(e)return void v.error(e);(await E({type:"loginName",value:G.value.trim(),password:O.value.trim(),nickname:H.value.trim()})).ErrorCode||v.success(`注册成功,即将自动登录~ ${G.value}`,{onClose(){M()}})};return U(((e,v)=>{const m=a("router-link");return s(),l("div",_,[t("div",R,[t("div",x,[A,t("div",null,[t(m,{to:"/"},{default:U((()=>[N])),_:1})])]),$,t("div",I,[t("div",T,[n(t("input",{type:"text",name:"account",id:"account","onUpdate:modelValue":v[1]||(v[1]=e=>G.value=e),placeholder:"账户登录名称,字母开头的5-16位数字和字母组合"},null,512),[[o,G.value,void 0,{trim:!0}]])]),S.value?(s(),l("div",j,[n(t("input",{type:"text",name:"nickname",id:"nickname","onUpdate:modelValue":v[2]||(v[2]=e=>H.value=e),placeholder:"用户昵称"},null,512),[[o,H.value,void 0,{trim:!0}]])])):i("",!0),t("div",null,[n(t("input",{type:"password",name:"password",id:"password","onUpdate:modelValue":v[3]||(v[3]=e=>O.value=e),placeholder:"登录密码"},null,512),[[o,O.value,void 0,{trim:!0}]])]),t("div",null,[S.value?(s(),l("button",{key:0,type:"button",class:"btn-login-register",onClick:P}," 立即注册 ")):(s(),l("button",{key:1,type:"button",class:"btn-login-register",onClick:M}," 立即登录 "))])]),t("div",V,[z,D,F,r(Z)?(s(),l(u,{key:0},[d("很少有人让我心动 但你是第"+c(r(Z))+"个。",1)],64)):i("",!0)])])])}))}});G.__scopeId="data-v-5c01e9b3";export default G;
